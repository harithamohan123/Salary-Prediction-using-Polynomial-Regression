# -*- coding: utf-8 -*-
"""SalaryPrediction_using_PolynomialRegression.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1YN1Obv13ZCw-jdJFwPdPACOnOOkHPcgf

Import Libraries
"""

import pandas as pd

"""Load files from directory"""

from google.colab import files
uploaded = files.upload()

"""Load dataset"""

dataset = pd.read_csv('dataset.csv')

"""Summarize dataset"""

print(dataset.shape)
print(dataset.head(5))

"""Segregate X(input) and Y(output)"""

x = dataset.iloc[:, :-1].values
y = dataset.iloc[:, -1].values
print(x)
print(y)

"""Training dataset with Linear regression"""

from sklearn.linear_model import LinearRegression
modelLR = LinearRegression()
modelLR.fit(x,y)

"""Visualize dataset usingLinear Regression"""

import matplotlib.pyplot as plt
plt.scatter(x,y, color="red")
plt.plot(x, modelLR.predict(x))
plt.title("Linear Regression")
plt.xlabel("level")
plt.ylabel("salary")
plt.show()

"""Convert x to polynomial format"""

from sklearn.preprocessing import PolynomialFeatures
  modelPR = PolynomialFeatures(degree = 4)
  xpoly = modelPR.fit_transform(x)

"""Train linear model by xploy instaed of x"""

modelPLR = LinearRegression()
modelPLR.fit(xpoly,y)

"""Visualize dataset"""

import matplotlib.pyplot as plt
plt.scatter(x,y, color="red")
plt.plot(x, modelPLR.predict(modelPR.fit_transform(x)))
plt.title("Polynomial Regression")
plt.xlabel("level")
plt.ylabel("salary")
plt.show()

"""Prediction using polynomial"""

x = 5
salaryPred = modelPLR.predict(modelPR.fit_transform([[x]]))
print("Salary of a person with level {0} is {1}".format(x,salaryPred))

